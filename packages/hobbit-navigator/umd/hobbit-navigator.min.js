!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path-to-regexp"),require("mithril")):"function"==typeof define&&define.amd?define(["path-to-regexp","mithril"],e):t.HobbitNavigator=e(null,t.Mithril)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},i={hashbanged:!1,location:null,hashbangPrefix:"#!"},a=function(){return"undefined"!=typeof window&&window.document?!(!window.history||!window.history.pushState)||(console.warn("It seems you are not using a browser with HTML5 history\n            support. Hobbit-navigator will cause the page to refresh rather\n            than navigate smoothly. Use a polyfil to prevent this issue."),!1):(console.warn("The history API for hobbit-navigator was executed on the\n            server, if this is an expected bahavior (For example, when using SSR),\n            set the location manually to display the intended content."),!1)},s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.configuration=Object.assign({},i,t),this.supported=a();var r=this.configuration,s=r.hashbanged,c=r.hashbangPrefix,u=r.location;u?this.location="object"===(void 0===u?"undefined":n(u))?u:{path:u,url:""+(s?c:"")+u,pattern:u,params:{},sender:""}:this.setLocationFromHref(),s&&window.addEventListener("hashchange",this.setLocationFromHref.bind(this))}return e.prototype.setLocationFromHref=function(){var t=this.configuration,e=t.hashbanged,n=t.hashbangPrefix,o=document.createElement("a");o.href=window.location.href;var r=e?o.hash.replace(n,""):o.pathname;this.location={path:r,url:e?o.hash:o.pathname,pattern:r,params:this.getState(),sender:""}},e.prototype.getLocation=function(){return this.location},e.prototype.getState=function(){return window.history.state||{}},e.prototype.extractParams=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.loose,o=void 0!==n&&n,r=e.caseSensitive,i=void 0===r||r,a=e.strict,s=void 0!==a&&a,c=this.executePattern(this.location.path,t,{end:!o,sensitive:i,strict:s}),u=c.match,h=c.keys;if(null===u)return null;var l=u.slice(1);return h.reduce(function(t,e,n){return t[e.name]=l[n],t},{})},e.prototype.executePattern=function(e,n,o){var r=[];return{keys:r,match:t(n,r,o).exec(e)}},e.prototype.navigate=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.params,r=void 0===o?{}:o,i=n.sender,a=void 0===i?"":i,s=n.force,c=void 0!==s&&s,u=n.options,h=(void 0===u?{}:u).replace||!1,l=t.compile(e)(r);(c||l!==this.location.path)&&this.navigatePure(l,r,{sender:a,replace:h,pattern:e})},e.prototype.navigatePure=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.sender,r=void 0===o?"":o,i=n.replace,a=void 0!==i&&i,s=n.pattern,c=this.configuration,u=c.hashbanged,h=c.hashbangPrefix,l=""+(u?h:"")+t;if(s||(s=t),this.location={path:t,pattern:s,url:l,sender:r,params:e},this.supported)a?window.history.replaceState(e,null,l):window.history.pushState(e,null,l);else{if(a)return void console.warn("The replace option is not available for browsers not\n                supporting the HTML5 history API.");window.location.href=l}},e.prototype.compare=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.loose,o=void 0!==n&&n,r=e.caseSensitive,i=void 0===r||r,a=e.strict,s=void 0!==a&&a,c=this.executePattern(this.location.path,t,{end:!o,sensitive:i,strict:s}).match;if(!c)return!1;var u=c[0];return!!o||new RegExp(this.location.path,i?"":"i").test(u)},e}(),c=void 0,u={oncreate:function(){window.addEventListener("hashchange",this.redrawNode.bind(this))},onremove:function(){window.removeEventListener("hashchange",this.redrawNode.bind(this))},redrawNode:function(){e.redraw()},view:function(t){return t.children}};function h(){var t={},o={};if(arguments.length<1)return console.error("The 'r' function expects at least one argument"),null;if("object"===n(arguments[0])?(t=arguments[0],arguments.length>1&&"object"===n(arguments[1])&&(o=arguments[1])):arguments.length>1&&(t[arguments[0]]=arguments[1],arguments.length>2&&"object"===n(arguments[2])&&(o=arguments[2])),!c)return console.error("The router was not initialized using 'createRouter'\n            before trying to render a route."),null;for(var i in t){var a=t[i];if(c.compare(i,o)){if("object"===(void 0===a?"undefined":n(a))&&a.tag&&"function"==typeof a.tag.view)return e(u,[Object.assign({},a,{attrs:r({},a.attrs,{location:Object.assign({},c.getLocation(),{params:c.extractParams(i,o)}),params:Object.assign({},c.getState(),c.extractParams(i,o))})})]);if("object"===(void 0===a?"undefined":n(a))&&a.tag)return e(u,[a])}}return null}return h.createRouter=function(t){c=new s(t)},h.getLocation=function(){return c?c.getLocation():(console.error("The router was not initialized using 'createRouter'\n            before trying to render a route."),null)},h.navigate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!c)return console.error("The router was not initialized using 'createRouter'\n            before trying to render a route."),null;c.navigate(t,Object.assign({},{params:e},n))},h.withLocation=function(t,n,o){return{view:function(i){return e(n,r({},i.attrs,{location:Object.assign({},c.getLocation(),{params:c.extractParams(t,o)}),params:Object.assign({},c.getState(),c.extractParams(t,o))}))}}},h});
